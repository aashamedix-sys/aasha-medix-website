import{j as e,D as G,E as H,r as l,c as u,t as n,S as J,I as c,a as p,b as v,d as j,e as g,f as i,B as o,P as U,C as D,M as $,x as K,y as Q,T as W,h as X,i as Y,k as Z,l as ee,n as ae,L as se}from"./index-4e8604e8.js";import{P as te}from"./pen-square-52e44937.js";const le=()=>{const[_,F]=l.useState([]),[L,b]=l.useState(!0),[N,R]=l.useState(""),[x,k]=l.useState("all"),[P,d]=l.useState(!1),[I,m]=l.useState(!1),[h,S]=l.useState(null),[y,w]=l.useState(!1),[s,r]=l.useState({full_name:"",email:"",role:"",phone:"",department:"",status:"Active"}),C=[{value:"lab",label:"Lab Technician"},{value:"phlebotomist",label:"Phlebotomist"},{value:"reception",label:"Receptionist"},{value:"admin",label:"Administrator"},{value:"doctor",label:"Doctor"}];l.useEffect(()=>{f()},[]);const f=async()=>{b(!0);try{const{data:a,error:t}=await u.from("staff").select("*").order("created_at",{ascending:!1});if(t)throw t;F(a||[])}catch(a){console.error("Error fetching staff:",a),n({variant:"destructive",title:"Error",description:"Failed to load staff list."})}finally{b(!1)}},O=async()=>{if(!s.email||!s.full_name||!s.role){n({variant:"destructive",title:"Validation Error",description:"Name, Email and Role are required."});return}w(!0);try{if(h){const{error:a}=await u.from("staff").update({full_name:s.full_name,role:s.role,phone:s.phone,department:s.department,status:s.status}).eq("id",h.id);if(a)throw a;n({title:"Success",description:"Staff member updated."})}else{const{error:a}=await u.from("staff").insert([{...s,created_at:new Date}]);if(a)throw a;n({title:"Success",description:"Staff member added."})}await f(),d(!1),m(!1),A()}catch(a){n({variant:"destructive",title:"Error",description:a.message||"Failed to save staff member."})}finally{w(!1)}},T=async a=>{if(window.confirm("Are you sure you want to remove this staff member?"))try{const{error:t}=await u.from("staff").delete().eq("id",a);if(t)throw t;n({title:"Deleted",description:"Staff member removed."}),f()}catch{n({variant:"destructive",title:"Error",description:"Failed to delete staff member."})}},M=a=>{S(a),r({full_name:a.full_name||"",email:a.email||"",role:a.role||"",phone:a.phone||"",department:a.department||"",status:a.status||"Active"}),m(!0)},A=()=>{S(null),r({full_name:"",email:"",role:"",phone:"",department:"",status:"Active"})},E=_.filter(a=>{if(!a)return!1;const t=(N||"").toLowerCase(),V=(a.full_name||"").toLowerCase(),q=(a.email||"").toLowerCase(),z=V.includes(t)||q.includes(t),B=x==="all"||a.role===x;return z&&B});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex flex-1 gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(J,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(c,{placeholder:"Search staff...",className:"pl-9",value:N,onChange:a=>R(a.target.value)})]}),e.jsxs(p,{value:x,onValueChange:k,children:[e.jsx(v,{className:"w-[180px]",children:e.jsx(j,{placeholder:"Filter Role"})}),e.jsxs(g,{children:[e.jsx(i,{value:"all",children:"All Roles"}),C.map(a=>e.jsx(i,{value:a.value,children:a.label},a.value))]})]})]}),e.jsxs(o,{onClick:()=>{A(),d(!0)},className:"bg-[#1FAA59] hover:bg-green-700",children:[e.jsx(U,{className:"w-4 h-4 mr-2"})," Add Staff"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L?Array(6).fill(0).map((a,t)=>e.jsx(D,{className:"h-40 animate-pulse bg-gray-100 border-0"},t)):E.length===0?e.jsx("div",{className:"col-span-full text-center py-12 bg-white rounded-xl border border-dashed text-gray-500",children:"No staff members found."}):E.map(a=>e.jsx(D,{className:"overflow-hidden hover:shadow-md transition-all group border-l-4 border-l-[#1FAA59]",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-50 flex items-center justify-center text-[#1FAA59] font-bold text-lg",children:a.full_name?a.full_name.charAt(0):"?"}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="Active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.status||"Active"})]}),e.jsx("h3",{className:"font-bold text-gray-900 truncate",children:a.full_name||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4 capitalize",children:a.role||"No Role"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("span",{className:"truncate",children:a.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("span",{children:a.phone||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx("span",{className:"capitalize",children:a.department||"General"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t border-gray-100",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>M(a),children:[e.jsx(te,{className:"w-3.5 h-3.5 mr-1"})," Edit"]}),e.jsxs(o,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>T(a.id),children:[e.jsx(W,{className:"w-3.5 h-3.5 mr-1"})," Remove"]})]})]})},a.id))}),e.jsx(X,{open:P||I,onOpenChange:a=>!a&&(d(!1),m(!1)),children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsx(ee,{children:h?"Edit Staff Member":"Add New Staff"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Full Name"}),e.jsx(c,{value:s.full_name,onChange:a=>r({...s,full_name:a.target.value}),placeholder:"John Doe"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsx(c,{type:"email",value:s.email,onChange:a=>r({...s,email:a.target.value}),placeholder:"staff@aashamedix.com",disabled:!!h})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Role"}),e.jsxs(p,{value:s.role,onValueChange:a=>r({...s,role:a}),children:[e.jsx(v,{children:e.jsx(j,{placeholder:"Select Role"})}),e.jsx(g,{children:C.map(a=>e.jsx(i,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(p,{value:s.status,onValueChange:a=>r({...s,status:a}),children:[e.jsx(v,{children:e.jsx(j,{placeholder:"Status"})}),e.jsxs(g,{children:[e.jsx(i,{value:"Active",children:"Active"}),e.jsx(i,{value:"Inactive",children:"Inactive"}),e.jsx(i,{value:"On Leave",children:"On Leave"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Phone"}),e.jsx(c,{value:s.phone,onChange:a=>r({...s,phone:a.target.value}),placeholder:"+91..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Department"}),e.jsx(c,{value:s.department,onChange:a=>r({...s,department:a.target.value}),placeholder:"e.g. Pathology, Reception"})]})]}),e.jsxs(ae,{children:[e.jsx(o,{variant:"outline",onClick:()=>{d(!1),m(!1)},children:"Cancel"}),e.jsx(o,{onClick:O,className:"bg-[#1FAA59] hover:bg-green-700",disabled:y,children:y?e.jsx(se,{className:"w-4 h-4 animate-spin mr-2"}):"Save Staff Member"})]})]})})]})},ie=()=>e.jsx(G,{title:"Staff Directory",children:e.jsx(H,{children:e.jsx(le,{})})});export{ie as default};
