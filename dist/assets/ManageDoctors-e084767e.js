import{j as e,D as z,E as U,r as l,c as u,t as c,S as Y,I as i,a as E,b as F,d as q,e as k,f as v,B as n,P as H,L as P,C as Q,T as R,g as $,h as J,i as K,k as W,l as X}from"./index-4e8604e8.js";import{P as Z}from"./pen-square-52e44937.js";const ee=()=>{const[N,O]=l.useState([]),[b,o]=l.useState(!0),[w,T]=l.useState(""),[p,B]=l.useState("all"),[S,d]=l.useState(!1),[I,m]=l.useState(!1),[h,D]=l.useState(null),[t,x]=l.useState({full_name:"",specialty:"",qualification:"",experience_years:"",fee:"",rating:"5.0",email:"",phone:"",is_available:!0}),C=["General Physician","Gynecologist","Dermatologist","Pediatrician","Orthopedic","ENT Specialist","Psychiatrist","Cardiologist","Neurologist","Ophthalmologist"];l.useEffect(()=>{f()},[]);const f=async()=>{o(!0);try{const{data:s,error:a}=await u.from("doctors").select("*").order("created_at",{ascending:!1});if(a)throw a;O(s||[])}catch(s){console.error("Fetch doctors error:",s),c({title:"Error",description:"Failed to fetch doctors",variant:"destructive"})}finally{o(!1)}},r=s=>{const{name:a,value:g,type:j,checked:y}=s.target;x(V=>({...V,[a]:j==="checkbox"?y:g}))},L=async s=>{s.preventDefault(),o(!0);try{if(h){const{error:a}=await u.from("doctors").update(t).eq("id",h.id);if(a)throw a;c({title:"Success",description:"Doctor updated successfully"})}else{const{error:a}=await u.from("doctors").insert([t]);if(a)throw a;c({title:"Success",description:"Doctor added successfully"})}d(!1),m(!1),f(),A()}catch(a){console.error(a),c({title:"Error",description:a.message,variant:"destructive"})}finally{o(!1)}},M=async s=>{if(window.confirm("Are you sure you want to delete this doctor?"))try{const{error:a}=await u.from("doctors").delete().eq("id",s);if(a)throw a;c({title:"Deleted",description:"Doctor record removed."}),f()}catch{c({title:"Error",description:"Failed to delete doctor",variant:"destructive"})}},G=s=>{D(s),x(s),m(!0)},A=()=>{D(null),x({full_name:"",specialty:"",qualification:"",experience_years:"",fee:"",rating:"5.0",email:"",phone:"",is_available:!0})},_=N.filter(s=>{if(!s)return!1;const a=String(s.full_name||"").toLowerCase(),g=String(w||"").toLowerCase(),j=a.includes(g),y=p==="all"||s.specialty===p;return j&&y});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex flex-1 gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(Y,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(i,{placeholder:"Search by name...",className:"pl-9",value:w,onChange:s=>T(s.target.value)})]}),e.jsxs(E,{value:p,onValueChange:B,children:[e.jsx(F,{className:"w-[180px]",children:e.jsx(q,{placeholder:"Specialty"})}),e.jsxs(k,{children:[e.jsx(v,{value:"all",children:"All Specialties"}),C.map(s=>e.jsx(v,{value:s,children:s},s))]})]})]}),e.jsxs(n,{onClick:()=>{A(),d(!0)},className:"bg-[#1FAA59] hover:bg-green-700 w-full md:w-auto",children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Add Doctor"]})]}),b?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(P,{className:"w-8 h-8 animate-spin text-[#1FAA59]"})}):_.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500 bg-white rounded-xl border border-dashed",children:N.length===0?"No doctors in database.":"No doctors found matching criteria."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:_.map(s=>e.jsx(Q,{className:"overflow-hidden hover:shadow-md transition-all group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ${s.active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:s.name?s.name.charAt(0):"?"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-blue-600",onClick:()=>G(s),children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-red-600",onClick:()=>M(s.id),children:e.jsx(R,{className:"w-4 h-4"})})]})]}),e.jsx("h3",{className:"font-bold text-gray-900 truncate",title:s.full_name,children:s.full_name||"Unknown Name"}),e.jsx("p",{className:"text-sm text-[#1FAA59] font-medium mb-2",children:s.specialty||"General"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-500 mb-4",children:[e.jsx("p",{children:s.qualification||"N/A"}),e.jsxs("p",{children:[s.experience_years||0," Years Exp."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600 text-xs font-bold",children:[e.jsx($,{className:"w-3 h-3 fill-current"})," ",s.rating||"5.0"]}),e.jsxs("div",{className:"font-bold text-gray-900",children:["₹",s.fee||0]})]})]})},s.id))}),e.jsx(J,{open:S||I,onOpenChange:s=>!s&&(S?d(!1):m(!1)),children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsx(W,{children:e.jsx(X,{children:h?"Edit Doctor":"Add New Doctor"})}),e.jsxs("form",{onSubmit:L,className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Full Name"}),e.jsx(i,{name:"full_name",value:t.full_name||"",onChange:r,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Specialty"}),e.jsxs(E,{value:t.specialty,onValueChange:s=>x(a=>({...a,specialty:s})),children:[e.jsx(F,{children:e.jsx(q,{placeholder:"Select"})}),e.jsx(k,{children:C.map(s=>e.jsx(v,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Qualification"}),e.jsx(i,{name:"qualification",value:t.qualification,onChange:r,placeholder:"e.g. MBBS, MD",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Experience (Years)"}),e.jsx(i,{name:"experience_years",type:"number",value:t.experience_years,onChange:r,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Fee (₹)"}),e.jsx(i,{name:"fee",type:"number",value:t.fee||"",onChange:r,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsx(i,{name:"email",type:"email",value:t.email,onChange:r})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Phone"}),e.jsx(i,{name:"phone",value:t.phone,onChange:r})]}),e.jsx("div",{className:"col-span-2 space-y-2",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"is_available",checked:t.is_available||!1,onChange:r,className:"w-4 h-4 text-[#1FAA59] rounded"}),e.jsx("span",{className:"text-sm font-medium",children:"Available for Booking"})]})}),e.jsxs("div",{className:"col-span-2 flex justify-end gap-2 mt-4",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>{d(!1),m(!1)},children:"Cancel"}),e.jsx(n,{type:"submit",className:"bg-[#1FAA59] hover:bg-green-700",children:b?e.jsx(P,{className:"w-4 h-4 animate-spin"}):h?"Update Doctor":"Save Doctor"})]})]})]})})]})},te=()=>e.jsx(z,{title:"Manage Doctors",children:e.jsx(U,{children:e.jsx(ee,{})})});export{te as default};
